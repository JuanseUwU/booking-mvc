<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Test SOAP Services</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        .service { margin: 20px 0; padding: 15px; border: 1px solid #ccc; }
        .success { background: #d4edda; }
        .error { background: #f8d7da; }
        button { padding: 10px 20px; margin: 5px; cursor: pointer; }
        pre { background: #f5f5f5; padding: 10px; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üß™ Prueba de Servicios SOAP</h1>
    
    <div class="service">
        <h2>Sabor Andino</h2>
        <button onclick="testSaborAndino()">Probar Sabor Andino</button>
        <div id="sabor-result"></div>
    </div>

    <div class="service">
        <h2>El Cangrejo Feliz</h2>
        <button onclick="testCangrejoFeliz()">Probar Cangrejo Feliz</button>
        <div id="cangrejo-result"></div>
    </div>

    <div class="service">
        <h2>WeWorkHub</h2>
        <button onclick="testWeWorkHub()">Probar WeWorkHub</button>
        <div id="wework-result"></div>
    </div>

    <div class="service">
        <h2>KM25 Madrid</h2>
        <button onclick="testKM25()">Probar KM25</button>
        <div id="km25-result"></div>
    </div>

    <div class="service">
        <h2>Alquiler Augye</h2>
        <button onclick="testAlquilerAugye()">Probar Alquiler Augye</button>
        <div id="augye-result"></div>
    </div>

    <script>
        async function testSoapService(name, url, namespace, method, body, resultId) {
            const resultDiv = document.getElementById(resultId);
            resultDiv.innerHTML = '<p>‚è≥ Probando...</p>';
            
            const soapEnvelope = `<?xml version="1.0" encoding="utf-8"?>
<soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/" 
               xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
               xmlns:xsd="http://www.w3.org/2001/XMLSchema">
  <soap:Body>
    ${body}
  </soap:Body>
</soap:Envelope>`;

            try {
                console.log(`Testing ${name}...`, { url, namespace, method });
                
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/xml; charset=utf-8',
                        'SOAPAction': `${namespace}/${method}`
                    },
                    body: soapEnvelope
                });

                const text = await response.text();
                console.log(`${name} Response:`, text);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                resultDiv.className = 'success';
                resultDiv.innerHTML = `
                    <p>‚úÖ <strong>√âxito</strong> - Status: ${response.status}</p>
                    <pre>${text.substring(0, 500)}...</pre>
                `;
            } catch (error) {
                console.error(`${name} Error:`, error);
                resultDiv.className = 'error';
                resultDiv.innerHTML = `
                    <p>‚ùå <strong>Error</strong></p>
                    <pre>${error.message}</pre>
                `;
            }
        }

        async function testSaborAndino() {
            await testSoapService(
                'Sabor Andino',
                'https://saborandino.runasp.net/Ws_IntegracionRestaurante.asmx',
                'http://SaborAndino.ec/Integracion',
                'buscarServicios',
                '<buscarServicios xmlns="http://SaborAndino.ec/Integracion"><filtros></filtros></buscarServicios>',
                'sabor-result'
            );
        }

        async function testCangrejoFeliz() {
            await testSoapService(
                'El Cangrejo Feliz',
                'https://elcangrejofeliz.runasp.net/WS_IntegracionRestaurante.asmx',
                'http://elcangrejofeliz.ec/Integracion',
                'buscarServicios',
                '<buscarServicios xmlns="http://elcangrejofeliz.ec/Integracion"><filtros></filtros></buscarServicios>',
                'cangrejo-result'
            );
        }

        async function testWeWorkHub() {
            await testSoapService(
                'WeWorkHub',
                'http://inegracion.runasp.net/WS_Integracion.asmx',
                'http://weworkhub/integracion',
                'buscarServicios',
                '<buscarServicios xmlns="http://weworkhub/integracion"><filtros><serviceType>hotel</serviceType></filtros></buscarServicios>',
                'wework-result'
            );
        }

        async function testKM25() {
            await testSoapService(
                'KM25 Madrid',
                'http://km25madrid.runasp.net/Services/HotelService.asmx',
                'http://mio.hotel/booking',
                'buscarServicios',
                '<buscarServicios xmlns="http://mio.hotel/booking"><filtros><ciudad></ciudad></filtros></buscarServicios>',
                'km25-result'
            );
        }

        async function testAlquilerAugye() {
            await testSoapService(
                'Alquiler Augye',
                'http://alquileraugye.runasp.net/AutosIntegracion.asmx',
                'http://tuservidor.com/booking/autos',
                'buscarServicios',
                '<buscarServicios xmlns="http://tuservidor.com/booking/autos"><filtros><serviceType>car</serviceType></filtros></buscarServicios>',
                'augye-result'
            );
        }
    </script>
</body>
</html>
